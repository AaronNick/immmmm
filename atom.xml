<?xml version="1.0" encoding="utf-8"?> 
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-CN">
    <generator uri="https://gohugo.io/" version="0.67.1">Hugo</generator><title type="html"><![CDATA[首页 on 木木木木木]]></title>
    
    
    
            <link href="https://immmmm.com/atom.xml" rel="self" type="application/rss+xml" title="atom" />
            <link href="https://immmmm.com/" rel="alternate" type="text/html" title="HTML" />
            <link href="https://immmmm.com/index.json" rel="alternate" type="application/json" title="JSON" />
    <updated>2020-05-13T00:55:59+00:00</updated>
    
    
    
    
        <id>https://immmmm.com/atom.xml</id>
    
        
        <entry>
            <title type="html"><![CDATA[定时任务唤醒体验版实例失败]]></title>
            <link href="https://immmmm.com/leancloud-auto-deploy/" rel="alternate" type="text/html" />
            
                <link href="https://immmmm.com/bb-by-wechat/" rel="related" type="text/html" title="「哔哔点啥」微信公众号" />
                <link href="https://immmmm.com/bb-by-alfred/" rel="related" type="text/html" title="撸个 Alfred 插件「b言b语」" />
                <link href="https://immmmm.com/vs-code-server/" rel="related" type="text/html" title="云 VSCode 云编码" />
                <link href="https://immmmm.com/just-bb-by-leancloud/" rel="related" type="text/html" title="废话胶囊，值得拥有" />
                <link href="https://immmmm.com/hugo-diy-post-type/" rel="related" type="text/html" title="Hugo 自定义文章样式" />
            
                <id>https://immmmm.com/leancloud-auto-deploy/</id>
            
            
            <published>2020-05-12T22:12:52+08:00</published>
            <updated>2020-05-12T22:12:52+08:00</updated>
            
            
            <content type="html"><![CDATA[<p>用了 <a href="https://valine.js.org/">Valine</a> 十有八九也都部署了 <a href="https://github.com/DesertsP/Valine-Admin">Valine Admin</a>，主要为了邮件通知。但最近 LeanCloud 应用日志一直报错：</p>
<pre><code>self_wake !! {&quot;error&quot;:&quot;因流控原因，通过定时任务唤醒体验版实例失败，建议升级至标准版云引擎实例避免休眠 https://url.leanapp.cn/dwAEksv&quot;}
</code></pre><p><img loading='lazy' src="https://lmm.elizen.me/images/2020/05/auto-deploy-1.png" alt="auto-deploy-1"  /></p>
<p>得手动进后台重启才行……</p>
<p>经 @Dyxang 指导，使用 Github Action 来实现应用实例的定时自动部署及唤醒。</p>
<h3 id="操作123">操作123</h3>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/05/auto-deploy-2.png" alt="auto-deploy-2"  /></p>
<p>1.生成 LeanCloud 应用的 <code>Deploy token</code>，暂存；</p>
<p>2.新建 Github 仓库，Settings - Secrets 添加一个名为 <code>DEPLOY_TOKEN</code> 的 secret，值为上一步的 <code>Deploy token</code>，继续点 <code>Actions -- New wordflow -- Set up a workflow yourself</code> ，添加如下代码，多个同时部署可参考：<a href="https://github.com/lmm214/leancloud-auto-deploy/blob/master/.github/workflows/auto-deploy.yml">leancloud-auto-deploy</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#75715e"># 定时重新部署，国际时间0点，即早上8点。</span>
<span style="color:#66d9ef">on</span>:
  <span style="color:#66d9ef">push</span>:
  <span style="color:#66d9ef">schedule</span>:
    - <span style="color:#66d9ef">cron</span>: <span style="color:#e6db74">&#39;0 0 * * *&#39;</span> 

<span style="color:#66d9ef">jobs</span>:
  <span style="color:#66d9ef">deploy</span>:
    <span style="color:#66d9ef">runs-on</span>: ubuntu-latest
    <span style="color:#66d9ef">steps</span>:
    - <span style="color:#66d9ef">uses</span>: actions/checkout@master

    <span style="color:#75715e">### 自定部署</span>
    - <span style="color:#66d9ef">name</span>: Deploy to LeanEngine
      <span style="color:#66d9ef">uses</span>: enflo/curl-action@master
      <span style="color:#66d9ef">with</span>:
        <span style="color:#66d9ef">curl</span>: -X POST https://console.leancloud.app/<span style="color:#ae81ff">1.1</span>/engine/groups/web/production/version?gitTag=master<span style="color:#75715e">&amp;token=${{</span> secrets.DEPLOY_TOKEN }}

</code></pre></div><p>3.睡一觉，等待明早8点！</p>
<h3 id="验证结果">验证结果</h3>
<p>成了，但要继续验证！</p>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/05/auto-deploy-3.png" alt="auto-deploy-3"  /></p>
<p>Github Action 早上8点定时任务出现排队等待，8:18分执行完毕，LeanCloud 应用部署启动完成。</p>
<p>但，仍在休眠中，显示 <code>生产环境 休眠中</code>，访问后台 <a href="https://xxxxx.avosapps.us">https://xxxxx.avosapps.us</a> 可以打开，此刻显示 <code>生产环境 运行中</code>，完成！</p>
<h3 id="继续验证">继续验证</h3>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/05/auto-deploy-4.png" alt="auto-deploy-4"  /></p>
<p>保留2个定时任务，按时间线： GitHub 8点定时部署  &ndash;&gt;  LeanCloud 8点30分自动唤醒  &ndash;&gt;  LeanCloud 9点补发邮件。</p>
<p>等，等等，等等！</p>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://immmmm.com/tags/%E6%8A%98%E8%85%BE" term="%E6%8A%98%E8%85%BE" label="折腾" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[「哔哔点啥」微信公众号]]></title>
            <link href="https://immmmm.com/bb-by-wechat/" rel="alternate" type="text/html" />
            
                <link href="https://immmmm.com/bb-by-alfred/" rel="related" type="text/html" title="撸个 Alfred 插件「b言b语」" />
                <link href="https://immmmm.com/vs-code-server/" rel="related" type="text/html" title="云 VSCode 云编码" />
                <link href="https://immmmm.com/just-bb-by-leancloud/" rel="related" type="text/html" title="废话胶囊，值得拥有" />
                <link href="https://immmmm.com/hugo-diy-post-type/" rel="related" type="text/html" title="Hugo 自定义文章样式" />
                <link href="https://immmmm.com/hugo-readdir-photos-single/" rel="related" type="text/html" title="Hugo 显示指定文件夹内图片" />
            
                <id>https://immmmm.com/bb-by-wechat/</id>
            
            
            <published>2020-05-10T20:22:49+08:00</published>
            <updated>2020-05-10T20:22:49+08:00</updated>
            
            
            <content type="html"><![CDATA[<p>看到 <a href="https://bearye.cn/archives/488">@熊野</a> 说可以用「微信公众号」发哔哔，还基于腾讯云函数，也能部署到 Leancloud ，立马 <del>勾搭</del> 加上微信好友。熊大神连夜折腾匹配一夜一天，远程手把手指导部署，整个过程：失败，等，失败，等等，失败，等等等等……成啦！太、太神奇！</p>
<figure>
    <img src="https://lmm.elizen.me/images/2020/05/bbds.png"/><figcaption>「哔哔点啥」微信公众号</figcaption></figure>

<h3 id="食用步骤">食用步骤</h3>
<p>1.按照原作者 <a href="https://sspai.com/post/60024">@daibor</a> 的教程在 Leancloud 建好应用，进入设置&ndash;应用 Keys，留存 <code>AppID</code>、<code>MasterKey</code>、<code>Request 域名</code>；</p>
<p>2.扫码关注「哔哔点啥」公众号（更名申请中），按照提示构建以下命令绑定：</p>
<pre><code>//bindCurrentUser:你的AppID,你的MasterKey,https://你的Request 域名
</code></pre><p>3.Done！</p>
<h3 id="风险预警">风险预警</h3>
<p>对于以上的id和key，微信公众号消息会有记录，腾讯云数据库也会储存，所以使用前请各位小伙伴斟酌。另外，后端使用的是免费配额，且用且珍惜。</p>
<p>最后，再次感谢 <a href="https://bearye.cn/">@熊野</a> 大神！</p>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://immmmm.com/tags/%E6%8A%98%E8%85%BE" term="%E6%8A%98%E8%85%BE" label="折腾" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[撸个 Alfred 插件「b言b语」]]></title>
            <link href="https://immmmm.com/bb-by-alfred/" rel="alternate" type="text/html" />
            
                <link href="https://immmmm.com/vs-code-server/" rel="related" type="text/html" title="云 VSCode 云编码" />
                <link href="https://immmmm.com/just-bb-by-leancloud/" rel="related" type="text/html" title="废话胶囊，值得拥有" />
                <link href="https://immmmm.com/hugo-diy-post-type/" rel="related" type="text/html" title="Hugo 自定义文章样式" />
                <link href="https://immmmm.com/hugo-readdir-photos-single/" rel="related" type="text/html" title="Hugo 显示指定文件夹内图片" />
                <link href="https://immmmm.com/hugo-total-count/" rel="related" type="text/html" title="Hugo 总文章数和总字数" />
            
                <id>https://immmmm.com/bb-by-alfred/</id>
            
            
            <published>2020-05-01T11:15:30+08:00</published>
            <updated>2020-05-01T11:15:30+08:00</updated>
            
            
            <content type="html"><![CDATA[<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/05/bb-1.png" alt="bb-1"  /></p>
<p>虽说 iOS 的快捷方式足够优雅，但还是想着 Mac 上也更舒坦地随意发布。VSCode 的 <a href="https://marketplace.visualstudio.com/items?itemName=humao.rest-client">REST Client</a> 插件能用但没有一键直达，看到 <a href="https://xwlearn.com/howto-graciously-bb-in-mac/">@xwlearn</a> 分享的 Python 代码，立马想到神器 「Alfred」！</p>
<h3 id="插件撸起">插件撸起</h3>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/05/bb-3.png" alt="bb-3"  /></p>
<p>安装依赖：</p>
<pre><code>sudo pip install urllib3
</code></pre><p>下载插件 <a href="https://immmmm.com/share/bb.alfredworkflow">「bb.alfredworkflow」</a>，修改其中的 <code>X-LC-Id</code> <code>X-LC-Key</code> 和 <code>url</code>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/local/bin/python3</span>
<span style="color:#75715e"># _*_ coding: utf-8 _*_</span>
<span style="color:#f92672">import</span> sys
<span style="color:#f92672">import</span> urllib3
<span style="color:#f92672">import</span> json
urllib3<span style="color:#f92672">.</span>disable_warnings(urllib3<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>InsecureRequestWarning)
data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;content&#34;</span>: <span style="color:#e6db74">&#34;{{query}}&#34;</span>}
headers <span style="color:#f92672">=</span> {
    <span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#39;application/json&#39;</span>,
    <span style="color:#e6db74">&#39;X-LC-Id&#39;</span>: <span style="color:#e6db74">&#39;&#39;</span>,   <span style="color:#75715e"># 填入AppID</span>
    <span style="color:#e6db74">&#39;X-LC-Key&#39;</span>: <span style="color:#e6db74">&#39;,master&#39;</span> <span style="color:#75715e"># 逗号前填入masterKey</span>
}
url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://AppID前八位.api.lncldglobal.com/1.1/classes/content&#39;</span> <span style="color:#75715e"># 国际版是前8位</span>
http <span style="color:#f92672">=</span> urllib3<span style="color:#f92672">.</span>PoolManager(timeout <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
r <span style="color:#f92672">=</span> http<span style="color:#f92672">.</span>request(<span style="color:#e6db74">&#39;POST&#39;</span>, url, body<span style="color:#f92672">=</span>json<span style="color:#f92672">.</span>dumps(data), headers <span style="color:#f92672">=</span> headers)
<span style="color:#66d9ef">if</span> str(r<span style="color:#f92672">.</span>status) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;201&#34;</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;success!&#39;</span>)
    <span style="color:#66d9ef">print</span>(json<span style="color:#f92672">.</span>loads(r<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)))
<span style="color:#66d9ef">else</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;something is wrong!&#39;</span>)
</code></pre></div><h3 id="题外话">题外话</h3>
<p>五一快乐，动起来！</p>
<p>🧹</p>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://immmmm.com/tags/%E6%8A%98%E8%85%BE" term="%E6%8A%98%E8%85%BE" label="折腾" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[云 VSCode 云编码]]></title>
            <link href="https://immmmm.com/vs-code-server/" rel="alternate" type="text/html" />
            
                <link href="https://immmmm.com/just-bb-by-leancloud/" rel="related" type="text/html" title="废话胶囊，值得拥有" />
                <link href="https://immmmm.com/hugo-diy-post-type/" rel="related" type="text/html" title="Hugo 自定义文章样式" />
                <link href="https://immmmm.com/hugo-readdir-photos-single/" rel="related" type="text/html" title="Hugo 显示指定文件夹内图片" />
                <link href="https://immmmm.com/hugo-total-count/" rel="related" type="text/html" title="Hugo 总文章数和总字数" />
                <link href="https://immmmm.com/hugo-shortcodes-music/" rel="related" type="text/html" title="Hugo 音乐短代码" />
            
                <id>https://immmmm.com/vs-code-server/</id>
            
            
            <published>2020-04-19T18:57:10+08:00</published>
            <updated>2020-04-19T18:57:10+08:00</updated>
            
            
            <content type="html"><![CDATA[<p><a href="https://github.com/cdr/code-server">code-server</a> 云 VSCode 云编码，安装踩坑无数，Docker 一条部署：</p>
<pre><code>docker run --name vscodeserver --user root -it -d -p 0.0.0.0:8080:8080 -e PASSWORD='youMiMa' -v &quot;$PWD:/home/coder/project&quot; codercom/code-server:latest
</code></pre><p>此刻 http://ip:8080 输入密码 <code>youMiMa</code> ，等等等失败，挂上特殊通道，等等等，成功。</p>
<h3 id="开启-https">开启 https</h3>
<p>以下步骤基于宝塔面板。添加网站，纯静态，开启 ssl Let&rsquo;s Encrypt，添加反响理代：</p>
<p>目标URL： <code>http://localhost:8080</code> 发送域名： <code>$host</code></p>
<p>照理这样也就OK了，但就算挂特殊通道还是报错，看教程，在配置文件中加入 <code>location</code> 这段代码：</p>
<pre><code>……
root /www/wwwroot/e.immmmm.com;
……
location /path/ {
  proxy_pass http://localhost:8080/;
  proxy_redirect http:// https://;
  proxy_set_header Host $host:443/path;
  proxy_set_header Upgrade $http_upgrade;
  proxy_set_header Connection upgrade;
  proxy_set_header Accept-Encoding gzip;
}
……
</code></pre><p>访问 <a href="https://e.immmmm.com/path/">https://e.immmmm.com/path/</a>  ，搞定！</p>
<h3 id="疑惑">疑惑</h3>
<p>不懂不懂，不加 <code>/path/</code> 为啥不行呢？</p>
<h3 id="后续">后续</h3>
<figure>
    <img src=""/></figure>

<p>原来 Coding 的也已经是 vscode ，每天免费4小时，除了 clone github 仓库好慢好慢，其它省心省心！</p>
<p>🤔️</p>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://immmmm.com/tags/%E6%8A%98%E8%85%BE" term="%E6%8A%98%E8%85%BE" label="折腾" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[2020-04-19]]></title>
            <link href="https://immmmm.com/2020-04-19/" rel="alternate" type="text/html" />
            
                <link href="https://immmmm.com/2020-04-12/" rel="related" type="text/html" title="2020-04-12" />
                <link href="https://immmmm.com/2020-04-10/" rel="related" type="text/html" title="2020-04-10" />
                <link href="https://immmmm.com/2020-04-04/" rel="related" type="text/html" title="2020-04-04" />
                <link href="https://immmmm.com/2020-03-23/" rel="related" type="text/html" title="2020-03-23" />
                <link href="https://immmmm.com/2020-03-09/" rel="related" type="text/html" title="2020-03-09" />
            
                <id>https://immmmm.com/2020-04-19/</id>
            
            
            <published>2020-04-19T13:36:58+08:00</published>
            <updated>2020-04-19T13:36:58+08:00</updated>
            
            
            <content type="html"><![CDATA[<p>闲逛发现 <a href="https://github.com/xCss/Valine/releases">Valine 1.4.4</a> 已发布，表情改为了图片形式（win下不会再一坨坨）、评论支持楼内回复（不会一直在顶部）、也有取消回复按钮，立马跟近匹配了样式。</p>
<p>另外，折腾了一晚上+一上午 <a href="https://github.com/cdr/code-server">code-server</a>，成是成了但体验不佳，可能部署在国内云会好些。</p>
<p>补充：群里得知神技能，直接拖本地图片到评论框试试？</p>
<p>🌧️</p>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://immmmm.com/tags/%E8%AF%8D%E7%A9%B7" term="%E8%AF%8D%E7%A9%B7" label="词穷" />
                            
                        
                    
                
            
        </entry>
    
</feed>
