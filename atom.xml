<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-CN">
    <generator uri="https://gohugo.io/" version="0.67.1">Hugo</generator><title type="html"><![CDATA[木木木木木]]></title>
    
    
    
            <link href="https://immmmm.com/atom.xml" rel="self" type="application/rss+xml" title="atom" />
            <link href="https://immmmm.com/" rel="alternate" type="text/html" title="HTML" />
            <link href="https://immmmm.com/index.json" rel="alternate" type="application/json" title="JSON" />
    <updated>2021-01-10T05:35:05+00:00</updated>
    
    
    
    
        <id>https://immmmm.com/atom.xml</id>
    
        
        <entry>
            <title type="html"><![CDATA[腾讯 CloudBase ，开启一键部署]]></title>
            <link href="https://immmmm.com/tx-cloudbase-framework/" rel="alternate" type="text/html" />
            
                <id>https://immmmm.com/tx-cloudbase-framework/</id>
            
            
            <published>2021-01-09T22:26:22+08:00</published>
            <updated>2021-01-09T22:26:22+08:00</updated>
            
            
            <content type="html"><![CDATA[<blockquote>
<p>一键部署按钮可以让公开的 Git 项目一键部署到云开发 CloudBase 上，大大简化用户部署的门槛，方便用户快速使用和体验应用。一键部署功能支持 Github，Gitlab，Coding，Gitee 等 Git 仓库地址。</p>
</blockquote>
<p>利用 <a href="https://docs.cloudbase.net/framework/plugins/">CloudBase Framework</a> 把应用配置写在一个 <code>cloudbaserc.json</code> 文件中，把这个配置和相关文件上传仓库，然后生成 <a href="https://docs.cloudbase.net/framework/deploy-button.html#bu-shu-an-niu-shi-ru-he-gong-zuo-de">一键部署按钮</a> 。</p>
<p>比如 BBer 的 Git仓库目录：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">├── bber
│   ├── index.js
│   └── package.json
└── cloudbaserc.json
</code></pre></div><p>它的一键部署链接，其实就下面这句：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">https://console.cloud.tencent.com/tcb/env/index?action=CreateAndDeployCloudBaseProject<span style="color:#960050;background-color:#1e0010">&amp;</span>appUrl=https://github.com/lmm214/bber<span style="color:#960050;background-color:#1e0010">&amp;</span>branch=main
</code></pre></div><p>打开链接 Tcb 会根据 <code>cloudbaserc.json</code> 内的配置自动构建云函数、数据库、云存储等等内容。以 BBer 为例，能不能一键部署成功，还得<del>看脸</del>看配置文件：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;2.0&#34;</span>,  <span style="color:#960050;background-color:#1e0010">//一开始随后改成</span> <span style="color:#960050;background-color:#1e0010">1.0</span> <span style="color:#960050;background-color:#1e0010">悲催一整夜！</span>
  <span style="color:#f92672">&#34;envId&#34;</span>: <span style="color:#e6db74">&#34;{{envId}}&#34;</span>,  <span style="color:#960050;background-color:#1e0010">//2.0才能用这个动态变量</span> <span style="color:#960050;background-color:#1e0010">{{envId</span>}<span style="color:#960050;background-color:#1e0010">}</span>
  <span style="color:#e6db74">&#34;functionRootPath&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#e6db74">&#34;.&#34;</span><span style="color:#960050;background-color:#1e0010">,</span>  <span style="color:#960050;background-color:#1e0010">//根目录就一个点</span>
  <span style="color:#e6db74">&#34;functions&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> [
    {
      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;bber&#34;</span>,
      <span style="color:#f92672">&#34;timeout&#34;</span>: <span style="color:#ae81ff">30</span>,
      <span style="color:#f92672">&#34;runtime&#34;</span>: <span style="color:#e6db74">&#34;Nodejs10.15&#34;</span>,
      <span style="color:#f92672">&#34;memorySize&#34;</span>: <span style="color:#ae81ff">128</span>,
      <span style="color:#f92672">&#34;handler&#34;</span>: <span style="color:#e6db74">&#34;index.main&#34;</span>
    }
  ]<span style="color:#960050;background-color:#1e0010">,</span>
  <span style="color:#e6db74">&#34;framework&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> {
    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;bber&#34;</span>,
    <span style="color:#f92672">&#34;plugins&#34;</span>: {
      <span style="color:#f92672">&#34;function&#34;</span>: {  <span style="color:#960050;background-color:#1e0010">//部署云函数文件</span> <span style="color:#960050;background-color:#1e0010">index.js</span> <span style="color:#960050;background-color:#1e0010">和</span> <span style="color:#960050;background-color:#1e0010">package.json</span>
        <span style="color:#f92672">&#34;use&#34;</span>: <span style="color:#e6db74">&#34;@cloudbase/framework-plugin-function&#34;</span>,
        <span style="color:#f92672">&#34;inputs&#34;</span>: {
          <span style="color:#f92672">&#34;functionRootPath&#34;</span>: <span style="color:#e6db74">&#34;.&#34;</span>,
          <span style="color:#f92672">&#34;functions&#34;</span>: [{ <span style="color:#960050;background-color:#1e0010">//云函数名儿</span>
              <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;bber&#34;</span>,
              <span style="color:#f92672">&#34;timeout&#34;</span>: <span style="color:#ae81ff">30</span>,
              <span style="color:#f92672">&#34;envVariables&#34;</span>: {},
              <span style="color:#f92672">&#34;runtime&#34;</span>: <span style="color:#e6db74">&#34;Nodejs10.15&#34;</span>,
              <span style="color:#f92672">&#34;memory&#34;</span>: <span style="color:#ae81ff">128</span>
          }],
          <span style="color:#f92672">&#34;servicePaths&#34;</span>: { <span style="color:#960050;background-color:#1e0010">//开启http访问链接</span>
            <span style="color:#f92672">&#34;bber&#34;</span>: <span style="color:#e6db74">&#34;/bber&#34;</span>
          }
        }
      },
      <span style="color:#f92672">&#34;client&#34;</span>: {  <span style="color:#960050;background-color:#1e0010">//创建数据库集合</span>
        <span style="color:#f92672">&#34;use&#34;</span>: <span style="color:#e6db74">&#34;@cloudbase/framework-plugin-database&#34;</span>,
        <span style="color:#f92672">&#34;inputs&#34;</span>: {
          <span style="color:#f92672">&#34;collections&#34;</span>: [
            {
              <span style="color:#f92672">&#34;collectionName&#34;</span>: <span style="color:#e6db74">&#34;talks&#34;</span>,  <span style="color:#960050;background-color:#1e0010">//集合名儿</span>
              <span style="color:#f92672">&#34;aclTag&#34;</span>: <span style="color:#e6db74">&#34;ADMINWRITE&#34;</span>  <span style="color:#960050;background-color:#1e0010">//权限为所有人可读仅管理员可写</span>
            }
          ]
        }
      }
    }
  }
<span style="color:#960050;background-color:#1e0010">}</span>
</code></pre></div><p>更多其它插件看官方文档：<a href="https://docs.cloudbase.net/framework/plugins/">云开发 CloudBase 插件</a></p>
<p>好了，简简单单一个配置文件一个链接，把 BBer 应用需要的手动云函数、手动数据库、手动HTTP访问链接，一键部署！</p>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://immmmm.com/tags/%E6%8A%98%E8%85%BE" term="%E6%8A%98%E8%85%BE" label="折腾" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[「哔哔点啥」微信公众号 2.0]]></title>
            <link href="https://immmmm.com/bb-by-wechat-pro/" rel="alternate" type="text/html" />
            
                <id>https://immmmm.com/bb-by-wechat-pro/</id>
            
            
            <published>2021-01-06T20:22:49+08:00</published>
            <updated>2021-01-06T20:22:49+08:00</updated>
            
            
            <content type="html"><![CDATA[<figure>
    <img src="https://lmm.elizen.me/images/2020/05/bbds.png"/><figcaption>「哔哔点啥」微信公众号 2.0</figcaption></figure>

<p>原是发到 LeanCloud 平台，现 2.0 是发到 <strong>「腾讯 CloudBase」</strong> 。目前已支持用户名绑定、解绑、发文字、<strong>发图片</strong>、<strong>批量删除</strong>。</p>
<blockquote>
<p><code>/l</code> - 显示最近哔哔</p>
<p><code>/a 文字</code> - 追加文字到第1条</p>
<p><code>/a数字 文字</code> - 追加文字到第几条，如 /a2 文字</p>
<p><code>/d</code> - 删除第1条</p>
<p><code>/d数字</code> - 删除第几条，如 /d2</p>
<p><code>/e 文字</code>- 编辑替换第1条</p>
<p><code>/e数字 文字</code> - 编辑替换第几条，如 /e2 文字</p>
<p><code>/f数字</code> - 批量删除前几条，如 /f2</p>
<p><code>/nobber</code> - 解除绑定</p>
<p><code>/bber KEY,HTTP访问地址</code> - 添加绑定</p>
</blockquote>
<p>对，绑定只需要2个信息，一个自定义的 <code>KEY</code> 和 <code>云函数的http访问地址</code></p>
<h3 id="日常使用截图">日常使用截图</h3>
<blockquote>
<p>使用 /a 命令给图片追加个文字，真香！</p>
</blockquote>
<figure>
    <img src="https://lmm.elizen.me/images/2020/12/bber-1.PNG" width="50%"/><img src="https://lmm.elizen.me/images/2020/12/bber-2.PNG" width="50%" />
    <figcaption>「哔哔点啥」操作截图-1</figcaption>
  </figure>
<figure>
    <img src="https://lmm.elizen.me/images/2020/12/bber-3.jpg" width="50%"/><img src="https://lmm.elizen.me/images/2020/12/bber-4.jpg" width="50%" />
    <figcaption>「哔哔点啥」操作截图-2</figcaption>
  </figure>
<h3 id="一键部署及绑定">一键部署及绑定</h3>
<p>1.点击以下按钮将 BBer 一键部署到云开发</p>
<p><a rel="link" href="https://console.cloud.tencent.com/tcb/env/index?action=CreateAndDeployCloudBaseProject&amp;appUrl=https%3A%2F%2Fgithub.com%2Flmm214%2Fbber&amp;branch=main"><img class="avatar" loading="lazy" src="https://main.qcloudimg.com/raw/67f5a389f1ac6f3b4d04c7256438e44f.svg" alt=""></a></p>
<p>2.进入<a href="https://console.cloud.tencent.com/tcb/env/login">环境-登录授权</a>，启用“匿名登录”</p>
<p>3.进入<a href="https://console.cloud.tencent.com/tcb/env/safety">环境-安全配置</a>，将博客网址添加到“WEB安全域名”</p>
<p>4.进入<a href="https://console.cloud.tencent.com/tcb/env/access">环境-HTTP访问服务</a>，复制链接备用。</p>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/bber-11.png" alt="bber-11"  /></p>
<p>5.进入<a href="https://console.cloud.tencent.com/tcb/scf/index">云函数</a>，修改自定义apikey <code>bber</code> 并保存备用。</p>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/bber-10.png" alt="bber-10"  /></p>
<p>6.扫码进入公众号，输入命名绑定：</p>
<pre><code>/bber bber,https://你的云函数HTTP访问地址/bber
</code></pre><blockquote>
<p>注明：一键部署虽然方便，但是仅支持按量计费环境，当然大多数（日访问量10000-）是够用的。如果您希望，当免费资源用尽时，不产生费用请使用手动部署。</p>
</blockquote>
<hr>
<h3 id="前端部署">前端部署</h3>
<p>暂时参考 <a href="https://github.com/lmm214/immmmm/blob/master/themes/hello-friend/layouts/_default/bb.html">bb.html</a></p>
<hr>
<h3 id="手动部署获取环境id">手动部署：获取环境ID</h3>
<p>1.<a href="https://curl.qcloud.com/KnnJtUom">注册云开发CloudBase</a></p>
<p>2.进入<a href="https://console.cloud.tencent.com/tcb/">云开发控制台</a>，新建环境，请按需配置环境</p>
<blockquote>
<p>提示：环境名称自由填写，推荐选择计费方式包年包月，套餐版本基础班 1，超出免费额度不会收费，如果提示选择“应用模板”，请选择“空模板”</p>
</blockquote>
<blockquote>
<p>推荐创建上海环境。如选择广州环境，需要在 twikoo.init() 时额外指定环境 region: &ldquo;ap-guangzhou&rdquo;</p>
</blockquote>
<p>3.进入<a href="https://console.cloud.tencent.com/tcb/env/login">环境-登录授权</a>，启用“匿名登录”</p>
<p>4.进入<a href="https://console.cloud.tencent.com/tcb/env/safety">环境-安全配置</a>，将网站域名添加到“WEB安全域名”</p>
<p>5.复制 <code>环境Id</code> 备用</p>
<h3 id="手动部署新建数据库">手动部署：新建数据库</h3>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/talks.jpg" alt="talks"  /></p>
<p>新建数据库集合，命名 <code>talks</code>，权限设置为 “所有用户可读，仅管理员可写”。</p>
<h3 id="手动部署云函数部署修改代码中的-自定义apikey-和-环境id">手动部署：云函数部署（修改代码中的 「自定义apikey」 和 「环境ID」）</h3>
<p>接着 <a href="https://console.cloud.tencent.com/tcb/scf/index">新建云函数</a> ，函数名称 <code>bber</code> （可自定义），进入 <code>函数代码</code> 编辑，复制 <a href="https://github.com/lmm214/bber/blob/main/src/function/bber/index.js">index.js</a> 代码丢入 <code>index.js</code>，然后确定。</p>
<p>完成后，点击“文件 - 新建文件”，复制 <a href="https://github.com/lmm214/bber/blob/main/src/function/bber/package.json">package.json</a> 代码丢入 <code>package.json</code>，点击 <code>保存并安装依赖</code>。</p>
<h3 id="手动部署开启-http-访问服务获取http访问地址">手动部署：开启 HTTP 访问服务,获取HTTP访问地址</h3>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/bb-tx-1.png" alt="bb-tx-1"  /></p>
<p>环境 &ndash; HTTP访问服务 &ndash; 开启 &ndash; 新建，路径与云函数名匹配。</p>
<p>现在可以点开看一下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">https://你后台显示的.ap-shanghai.app.tcloudbase.com/bber
</code></pre></div><p>提示 <code>key不匹配</code>，成功！留存此链接！！！</p>
<h3 id="扫码绑定">扫码，绑定</h3>
<figure>
    <img src="https://lmm.elizen.me/images/2020/05/bbds.png"/><figcaption>「哔哔点啥」微信公众号 2.0</figcaption></figure>

<pre><code>/bber bber,https://你的云函数HTTP访问地址/bber
</code></pre><hr>
<h3 id="附赠-alfred-workflow">附赠 Alfred Workflow</h3>
<p>其实公众号仅用作了转发文字内容，具体功能都是各自地方，好处是，访问以下格式链接也能用。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">https://你后台显示的.ap-shanghai.app.tcloudbase.com/bb?key=云函数里设置的<span style="color:#960050;background-color:#1e0010">&amp;</span>from=自己发挥一个<span style="color:#960050;background-color:#1e0010">&amp;</span>text=哔哔的内容
</code></pre></div><p>比如用 Alfred 的这个 <a href="https://github.com/lmm214/diybug/raw/main/%E6%B5%AE%E5%93%94%E4%BA%BA%E7%94%9F2.0.alfredworkflow">浮哔人生.alfredworkflow</a></p>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/fbrs.png" alt="fbrs.png"  /></p>
<p>输入好对应的 HTTP访问地址、KEY ，输入 <code>b /d</code> 就能删除最新一条哔哔</p>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://immmmm.com/tags/%E6%8A%98%E8%85%BE" term="%E6%8A%98%E8%85%BE" label="折腾" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[二〇二一，你好]]></title>
            <link href="https://immmmm.com/hi-2021/" rel="alternate" type="text/html" />
            
                <id>https://immmmm.com/hi-2021/</id>
            
            
            <published>2021-01-02T14:22:57+08:00</published>
            <updated>2021-01-02T14:22:57+08:00</updated>
            
            
            <content type="html"><![CDATA[<p>回望，过去这一年，在如此不确定下仍能过着几乎正常的生活，万分庆幸！</p>
<p>生命不止，折腾不息。</p>
<h3 id="gridea">Gridea</h3>
<p>弃用某静态托管平台，启用 <a href="https://gridea.dev/">Gridea</a> 分离出 <a href="https://i.immmmm.com/">「林小沐」</a> “晒娃”子博客。</p>
<p>转制了几款主题： <a href="https://immmmm.com/gridea-theme-puti/">Gridea Theme Puti</a>、<a href="https://immmmm.com/gridea-theme-motify/">Gridea Theme Motify</a>、<a href="https://immmmm.com/gridea-theme-webstack/">Gridea Theme WebStack</a></p>
<h3 id="hugo">Hugo</h3>
<p>感谢 <a href="https://dearroy.com/">@罗伊</a> 收留这小站，借助 VS Code + Github + VPS 开启静态博客新体验！前两项实现多设备同步数据，后一项实现域名管理、站点提速。</p>
<p>也相应折腾了些，如： <a href="https://github.com/lmm214/immmmm/tree/master/themes/hello-friend">「hello-friend」自用版</a>、<a href="https://immmmm.com/hugo-theme-webstack/">Hugo Theme Webstack</a></p>
<h3 id="评论和哔哔">评论和哔哔</h3>
<p>停用 Leancloud，转入腾讯云 Cloudbase，舒心多了，被流控邮件提醒烦了。</p>




	
		
	


<div class="post-preview">
  <div class="post-preview--meta" style="width:100%;">
    <div class="post-preview--middle">
      <h4 class="post-preview--title">
        <a target="_blank" href="https://immmmm.com/hello-twikoo-comment/">启用 Twikoo 评论系统</a>
      </h4>
      <time class="post-preview--date">2020-11-21</time>
      
      <small>#折腾&nbsp;</small>
      
      <section style="max-height:96px;overflow:hidden;" class="post-preview--excerpt">
        感谢 @iMaeGoo 大神用爱发电，顺利启用 Twikoo 评论系统，并完美迁移 Valine 评论数据。
下午在 @大大的小蜗牛  博客看到评论系统右下角竟然不是 Valine 哦，赫然显示这 Twikoo，啥？！
原来是基于腾讯云开发的评论系统，换！

      </section>
    </div>
  </div>
  
</div>





	
		
			
			
		
	


<div class="post-preview">
  <div class="post-preview--meta" style="width:100%;">
    <div class="post-preview--middle">
      <h4 class="post-preview--title">
        <a target="_blank" href="https://immmmm.com/bb-tx-cloudbase/">哔哔 CloudBase</a>
      </h4>
      <time class="post-preview--date">2020-12-27</time>
      
      <small>#折腾&nbsp;</small>
      
      <section style="max-height:96px;overflow:hidden;" class="post-preview--excerpt">
        肝了一下午，顺利把 哔哔 由 LeanCloud 迁移至腾讯 CloudBase ！页面打开、各端bb，飞起！
基本思路：使用 HTTP 访问云函数 触发 云函数 插入新哔哔到 数据库，搞定！
CloudBase 环境部署 参考 https://twikoo.js.org/quick-start.html 完成环境部署。

      </section>
    </div>
  </div>
  
    <img rel="link" loading="lazy" class="post-preview--image avatar" src="https://lmm.elizen.me/images/2020/12/bb-tx-1.png">
  
</div>

<p>有些功能被限，总有人出来继续造轮子！再次感谢 <a href="https://www.imaegoo.com/">@iMaeGoo</a> !</p>
<h3 id="微信小程序">微信小程序</h3>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2021/01/xcx.png" alt="xcx"  /></p>
<p>前后边学边做将近三年，用 <a href="https://cloud.minapp.com/">知晓云</a> 作为后端和 <a href="https://github.com/weilanwl/ColorUI">ColorUI</a> 样式库，基本上已发开出自己想开发的功能，从最初每年几百的后端费用，现在累计广告收入也有 3K，大部分收入是特殊时期。当然，平常也就几毛，刚出了个开屏广告，每天又能多个几毛，月底勉强攒美式！</p>
<p>对于折腾，不再偏执追求像素级、100% Online，适当的妥协能让自己多睡几天早觉。</p>
<h3 id="玩物废志">玩物废志</h3>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2021/01/brawl.PNG" alt="brawl"  /></p>
<p>年中成为 Nintendo Switch 国行勇士一员，旷野肝了200h+，荒野肝了6K多场，无数次凌晨，如知吸烟有害依然照吸不误，以此自我说明基因强大。</p>
<h3 id="十年之约">十年之约</h3>
<figure>
    <img src="https://lmm.elizen.me/images/2021/01/foreverblog-1.png"/><figcaption>博客十年之约</figcaption></figure>

<p>RSS聚合：<a href="http://rss.foreverblog.cn/">http://rss.foreverblog.cn/</a></p>
<p>当初也利用 Google API 整过一个，现在坚持用 feed 订阅算是一种情怀啦！</p>
<h3 id="阅读刷剧">阅读刷剧</h3>
<p>工作外的八小时，带娃、看书、刷剧、刷圈……都要！让自己成为有点俗、有点雅、有点意思不单调的人。</p>
<p>阅读上几乎都是“医学”和“教育”主题，异常赞同这句“理论的实践性解读，教学实践的理论性反思”，特别对于一线实践的我们来说，更应该体现自己的“实践智慧”，避免教学改革常见弊病，即一直在追赶潮流，最终却一无所成。</p>
<p>感慨，挑书不误看书功。追着一本里的一串参考书目，大大降低踩坑几率。</p>
<p><a href="https://movie.douban.com/subject/33477335/">https://movie.douban.com/subject/33477335/</a></p>
<p><a href="https://movie.douban.com/subject/30223100/">https://movie.douban.com/subject/30223100/</a></p>
<p><a href="https://movie.douban.com/subject/25806638/">https://movie.douban.com/subject/25806638/</a></p>
<p>刷剧，感慨，平淡是真！</p>
<h3 id="结语">结语</h3>
<p>遗憾总归有的，过去的就让他过去吧，抬头是星辰大海，低头是爱与被爱。</p>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://immmmm.com/tags/%E6%97%A5%E5%B8%B8" term="%E6%97%A5%E5%B8%B8" label="日常" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[哔哔 Pro]]></title>
            <link href="https://immmmm.com/bb-pro/" rel="alternate" type="text/html" />
            
                <id>https://immmmm.com/bb-pro/</id>
            
            
            <published>2020-12-28T23:39:12+08:00</published>
            <updated>2020-12-28T23:39:12+08:00</updated>
            
            
            <content type="html"><![CDATA[<h3 id="pro-n01">Pro N0.1</h3>
<p>前端支持链接、图片显示。发哔哔的时候插入图片链接或网址链接，会自动识别显示。核心代码来自 <a href="https://www.heson10.com/">@黑石</a> :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">urlToLink</span>(<span style="color:#a6e22e">str</span>) {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">re</span> <span style="color:#f92672">=</span><span style="color:#e6db74">/\bhttps?:\/\/(?!\S+(?:jpe?g|png|bmp|gif|webp|gif))\S+/g</span>;
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">re_forpic</span> <span style="color:#f92672">=</span><span style="color:#e6db74">/\bhttps?:\/\/.*?(\.gif|\.jpeg|\.png|\.jpg|\.bmp|\.webp)/g</span>;
  <span style="color:#a6e22e">str</span> <span style="color:#f92672">=</span><span style="color:#a6e22e">str</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">re</span>,<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">website</span>) {
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&lt;a href=&#39;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">website</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39; target=&#39;_blank&#39;&gt; &lt;i class=&#39;iconfont icon-lianjie-copy&#39;&gt;&lt;/i&gt;链接 &lt;/a&gt;&#34;</span>;
  });
  <span style="color:#a6e22e">str</span> <span style="color:#f92672">=</span><span style="color:#a6e22e">str</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">re_forpic</span>,<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">imgurl</span>) {
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&lt;img src=&#39;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">imgurl</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;  /&gt; &#34;</span>;
  });
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">str</span>;
}
</code></pre></div><p>完整代码参考本主题 <a href="https://github.com/lmm214/immmmm/blob/master/themes/hello-friend/layouts/_default/bb.html">bb.html</a> ，主要加了上面的过滤正则 <code>urlToLink(item.content)</code> 。</p>
<h3 id="pro-n02">Pro N0.2</h3>
<p>接入 <a href="https://7bu.top/">去不图床</a> ，注册之后访问：</p>
<p><code>https://7bu.top/api/token?email=你的邮箱&amp;password=你的密码</code> 记下 <code>token</code> 值。</p>
<p><a href="https://7bu.top/index/api.html">图片上传API</a> 异常直接，post <code>https://7bu.top/api/upload</code> ，header 带上自己的 <code>token</code>，不带则匿名上传。用表单的请求参数 <code>image</code> 提交 <code>File</code>。</p>
<p>相关教程：<a href="https://dusays.com/241/">去不图床PicGo上传插件的使用</a>、<a href="https://blog.svend.cc/upic/tutorials/custom/">uPic 图床配置教程 - 自定义</a></p>
<h3 id="pro-n03">Pro N0.3</h3>
<p>iOS 快捷指令上传图片后返回链接，到哔哔输入框。</p>
<p><photos><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/bbpro-1.jpeg" alt="bbpro-1"  /><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/bbpro-2.jpeg" alt="bbpro-2"  /><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/bbpro-3.png" alt="bbpro-3"  /><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/bbpro-4.png" alt="bbpro-4"  /></photos></p>
<p>甚至用“快捷指令调用其他指令”实现同步发哔哔和Flomo。</p>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/bbpro-5.jpeg" alt="bbpro-5"  /></p>
<p>具体其他平台发布方式，改日改日再琢磨～</p>
]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://immmmm.com/tags/%E6%8A%98%E8%85%BE" term="%E6%8A%98%E8%85%BE" label="折腾" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[哔哔 CloudBase]]></title>
            <link href="https://immmmm.com/bb-tx-cloudbase/" rel="alternate" type="text/html" />
            
                <id>https://immmmm.com/bb-tx-cloudbase/</id>
            
            
            <published>2020-12-27T23:58:17+08:00</published>
            <updated>2020-12-27T23:58:17+08:00</updated>
            
            
            <content type="html"><![CDATA[<p>肝了一下午，顺利把 <a href="https://immmmm.com/bb/">哔哔</a> 由 LeanCloud 迁移至腾讯 CloudBase ！页面打开、各端bb，飞起！</p>
<p>基本思路：<a href="https://cloud.tencent.com/document/product/876/41776">使用 HTTP 访问云函数</a> 触发 <a href="https://cloud.tencent.com/document/product/876/46798">云函数</a> 插入新哔哔到 <a href="https://cloud.tencent.com/document/product/876/19362">数据库</a>，搞定！</p>
<h3 id="cloudbase-环境部署">CloudBase 环境部署</h3>
<p>参考  <a href="https://twikoo.js.org/quick-start.html">https://twikoo.js.org/quick-start.html</a> 完成环境部署。</p>
<h3 id="旧数据转化">旧数据转化</h3>
<p>把 LC 上的评论导出并进行格式转化，形成如下格式，<code>from</code> 字段是我自己后来加的。</p>
<pre><code>{&quot;_id&quot;:&quot;4ec5c2495fe84db1000046a47026ed51&quot;,&quot;from&quot;:&quot;Alfred&quot;,&quot;content&quot;:&quot;恶果之地得到各“金卡”莫名就通关+1&quot;,&quot;date&quot;:{&quot;$date&quot;:&quot;2020-12-27T07:38:10.844Z&quot;}}
</code></pre><p>数据库 &ndash; 新建集合，<code>talks</code> （当然可自定）导入json ，权限设为“所有用户可读，仅管理员可写“。</p>
<h3 id="html-显示代码">html 显示代码</h3>
<p>参考： <a href="https://github.com/lmm214/immmmm/blob/master/themes/hello-friend/layouts/_default/bb.html">https://github.com/lmm214/immmmm/blob/master/themes/hello-friend/layouts/_default/bb.html</a></p>
<p>修改其中的 环境id ，匹配自己的主题样式。</p>
<h3 id="云函数代码">云函数代码</h3>
<p>接着 <a href="https://console.cloud.tencent.com/tcb/scf/index">新建云函数</a> ，函数名称 <code>bb</code> （可自定义），进入 <code>函数代码</code> 编辑节目，把以下代码丢入 <code>index.js</code>，然后确定。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#e6db74">&#39;use strict&#39;</span>;
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">serverkey</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;xxxx&#39;</span> <span style="color:#75715e">//自定义api key
</span><span style="color:#75715e">//引入模块
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tcb</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;@cloudbase/node-sdk&#34;</span>);
<span style="color:#75715e">//云开发初始化
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tcb</span>.<span style="color:#a6e22e">init</span>({
  <span style="color:#a6e22e">env</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bb-bbbb&#34;</span> <span style="color:#75715e">//填入自己的环境ID
</span><span style="color:#75715e"></span>});
<span style="color:#75715e">//数据库初始化
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">db</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">database</span>()

<span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">main</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">event</span>, <span style="color:#a6e22e">context</span>) =&gt; {
    <span style="color:#75715e">//return event
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">apikey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">queryStringParameters</span>.<span style="color:#a6e22e">key</span>
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">content</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
    <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">serverkey</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">apikey</span> ){
        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">talksCollection</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">collection</span>(<span style="color:#e6db74">&#39;talks&#39;</span>)
        <span style="color:#75715e">//提取消息内容，发送者，接受者，时间戳，消息类型，内容
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">CreateTime</span> <span style="color:#f92672">=</span> Date.<span style="color:#a6e22e">now</span>(),
            <span style="color:#a6e22e">Content</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">queryStringParameters</span>.<span style="color:#a6e22e">text</span>,
            <span style="color:#a6e22e">From</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">queryStringParameters</span>.<span style="color:#a6e22e">from</span>
        <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">Content</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;/unbb&#39;</span>){ <span style="color:#75715e">//删除最新一条哔哔
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">talksCollection</span>.<span style="color:#a6e22e">where</span>({}).<span style="color:#a6e22e">orderBy</span>(<span style="color:#e6db74">&#34;date&#34;</span>, <span style="color:#e6db74">&#34;desc&#34;</span>).<span style="color:#a6e22e">limit</span>(<span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">get</span>()
            <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">deId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">data</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">_id</span>
            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">resDe</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">talksCollection</span>.<span style="color:#a6e22e">doc</span>(<span style="color:#a6e22e">deId</span>).<span style="color:#a6e22e">remove</span>();
            <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">resDe</span>.<span style="color:#a6e22e">hasOwnProperty</span>(<span style="color:#e6db74">&#39;deleted&#39;</span>)){
                <span style="color:#a6e22e">content</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;删除成功&#39;</span>
            }<span style="color:#66d9ef">else</span>{
                <span style="color:#a6e22e">content</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;删除失败&#39;</span>
            }
        }<span style="color:#66d9ef">else</span>{
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">talksCollection</span>.<span style="color:#a6e22e">add</span>({<span style="color:#a6e22e">content</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Content</span>, <span style="color:#a6e22e">date</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Date(<span style="color:#a6e22e">CreateTime</span>), <span style="color:#a6e22e">from</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">From</span>})
            <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">hasOwnProperty</span>(<span style="color:#e6db74">&#39;id&#39;</span>)){
                <span style="color:#a6e22e">content</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;发表成功&#39;</span>
            }<span style="color:#66d9ef">else</span>{
                <span style="color:#a6e22e">content</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;发表失败&#39;</span>
            }
        }
    }<span style="color:#66d9ef">else</span>{
        <span style="color:#a6e22e">content</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;key不匹配&#34;</span>
    }
    <span style="color:#66d9ef">return</span> {
        <span style="color:#a6e22e">content</span>
    };
}
</code></pre></div><p>完成后，点击“文件 - 新建文件”，输入 package.json，回车，复制以下代码粘贴，点击“保存并安装依赖”。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bb&#34;</span>,
    <span style="color:#e6db74">&#34;version&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;1.0.0&#34;</span>,
    <span style="color:#e6db74">&#34;main&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;index.js&#34;</span>,
    <span style="color:#e6db74">&#34;dependencies&#34;</span><span style="color:#f92672">:</span> {<span style="color:#e6db74">&#34;@cloudbase/node-sdk&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;latest&#34;</span>}
}
</code></pre></div><h3 id="开启-http-访问服务">开启 HTTP 访问服务</h3>
<p><img loading='lazy' src="https://lmm.elizen.me/images/2020/12/bb-tx-1.png" alt="bb-tx-1"  /></p>
<p>环境 &ndash; HTTP访问服务 &ndash; 开启 &ndash; 新建，路径与云函数名匹配。</p>
<p>现在可以点开看一下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">https://你后台显示的.ap-shanghai.app.tcloudbase.com/bb
</code></pre></div><p>提示 <code>key不匹配</code>，阶段性成功！</p>
<h3 id="构建-http-请求">构建 http 请求</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">https://你后台显示的.ap-shanghai.app.tcloudbase.com/bb?key=云函数里设置的<span style="color:#960050;background-color:#1e0010">&amp;</span>from=自己发挥一个<span style="color:#960050;background-color:#1e0010">&amp;</span>text=哔哔的内容
</code></pre></div><p>http 加了3个参数， <code>key</code> <code>from</code> <code>text</code> ，浏览器一发，搞定！</p>
<h3 id="几句后话">几句后话</h3>
<p>发图行不行，应该行！</p>
<p>多用户行不行，应该行！</p>
<p>可，文档太水，再看看再看看！</p>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://immmmm.com/tags/%E6%8A%98%E8%85%BE" term="%E6%8A%98%E8%85%BE" label="折腾" />
                            
                        
                    
                
            
        </entry>
    
</feed>
